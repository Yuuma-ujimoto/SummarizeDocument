# PHPを爆速で復習しよう

## はじめに

PHPはWEBページ上でプログラミング言語で.phpという拡張子を使う

### サンプルコード

```php+HTML
<!DOCTYPE html>
<html lang="ja">
	<head>
    	<meta charset="UTF-8">
        <title>PHP Sample</title>
	</head>
    <body>
        <?php
        	/*<?php～?>で囲った部分にPHPを書き込む*/
        	print("PHP TEST");
        ?>
    </body>
</html>
```



## PHPでの文字の出力

PHPで文字を出力するには**echo**関数もしくは**print**関数を用います。

echoとprintには若干の違いがあるものの基本的に性質は変わらないので今はあまり気にする必要はありませんがどちらかの関数に統一したほうが良いです

### サンプルコード

```php+HTML
<!DOCTYPE html>
<html lang="ja">
	<head>
    	<meta charset="UTF-8">
        <title>PHP Sample</title>
	</head>
    <body>
        <?php
        	print("PHP TEST");
        	print(10+5);
        	//数式を入れると計算結果が出る
        	print("<h1>aaaa</h1>");
        	//htmlのタグを埋め込むことも可能
        ?>
    </body>
</html>
```

※以降サンプルコード等は必要がない限りhtml部分を省略します。

## 変数

C言語でも変数は勉強しましたがC言語の変数とPHP変数は少し形式が違います。

最大の違いは型の定義がいらないことです。

そして変数の先頭に$(セクション/4+Shiftで出せます)を付けることです。

```
//C言語
int num = 100;
//PHP
$num = 100;
```

#### 標準出力に変数を埋め込む

```php
<?php 
    $num = 100;
	print($num);
	print("変数に入っている値は".$num."です。");
	// .で変数と文字列を結合できる(変数同士・文字列同士も可)
?>
```



## 条件分岐 if/else/else if

指定した条件で処理を変えるにはif文を使います。

if文の条件式がTrueならif文の中の処理を実行します。

もし条件式がFalseでelse if文が下にくっついてる場合はelse if文の条件式を判断しelse ifがTrueならばelse if文の処理を実行します。

全てのif文/else if文の条件式がFalseの場合else文がある場合はelse文の中の処理を実行します。

```php
<?php
    $num = 100;
	if ($num < 200){//numが500未満の時の条件式
        print("numは200よりも少ない値です。");
    }
	else if ($num < 1000){//if文の条件に当てはまらなかったらここの条件式を判断
        print("numは200よりも大きな値ですが1000よりも少ない値です。")
    }
	else if(){//上のelse ifにも当てはまらなかったら次のelse ifを判断という感じでやっていく
        //略
    }
	else{//ifもelse ifも条件に当てはまらなかったら実行
        print("numは1000よりも大きな値です。");
    }
?>
```

#### 比較演算子

条件式に使える比較演算子の一覧です。(これ以外にもありますがさほど重要ではないので割愛します)

| 記号   | 意味                                                         |
| ------ | ------------------------------------------------------------ |
| A < B  | AはB未満ならTrue                                             |
| A > B  | AはBよりも大きいとTrue/AとBが等しい場合はFalse               |
| A <= B | AはB以下ならTrue/AとBが等しくてもTrue                        |
| A >= B | AはB以上ならTrue/AとBが等しくてもTrue                        |
| A == B | AとBは等しいならTrue                                         |
| A != B | AとBは等しくないならTrue                                     |
| A===B  | 特殊なケースなので今はあんまり覚えなくていい<br />値が型も含めて同じならTrue<br />(例数値の1と文字の1を比較するとFalseになる) |

####  論理演算子

| 記号 | 形式         | 説明                                                         |
| ---- | ------------ | ------------------------------------------------------------ |
| AND  | 式A AND 式B  | 左右の式がTrueを返すときにTrueを返す・左右どちらかの式がFalseを返すとFalseを返す |
| OR   | 式A　OR　式B | 左右どちらかの式がTrueを返せばTrueを返す・左右どちらの式もFalseの場合のみFalseを返す |
| NOT  | NOT　式A     | 後ろにつけた式がTrueならFalse・FalseならTrueを返す(式の結果を逆転させる) |



## 反復 While文For文　

両方とも繰り返し処理を実行したいときに使います。

### While文

```PHP
<?php
    $num = 10;
    while($num != 0){//
        print($num);
        $num--;//numの値を-1する
    }
?>
```

whileの後ろの条件文がTrueを返すとき中の処理を繰り返します。Trueを入れると無限ループします。

無限ループ中でもbreakという命令があればループから抜けることができます。

```PHP
<?php
    $num = 0;
    while(True){//
        print($num);
       	$num++;//numの値を+1する
        if($num==10){
            //numの値が10になったらbreakでループを抜ける
            break;
        }
    }
?>
```

#### Do While文

```PHP
$i = 0
do{
    print($i);
    $i++;
}while($i<10);
```

While文の兄弟のような構文でwhile文と基本的な性質は同じだがループの継続判定がループの終わりにあるのが特徴

これによりdo while文は継続の条件の内容に関係なく必ず一回は処理を実行します。

### for文

```PHP
<?php
    for($i=0;$<=10;$i++){
        print($i);
    }
?>
```

個人的にFor文がわからなくてプログラミング挫折した人多そうって思ってる。

for文はかっこの中身の;で区切られた三つの命令で構成されています。

-----

まず一番左の

```PHP
$i = 0;
//変数iというものを宣言して0を入れている
```

これはfor文が実行されるとき最初に処理される命令になります。

----

真ん中の

```PHP
$i <= 10
```

これは先ほどのwhileと似たような条件式でこの式がTrueを返す限りfor文で囲われた処理を実行する(言い換えるとループの継続)という意味になります。

サンプルコードでは変数$iの値が10以下ならループを継続するという意味になっています。

----

一番右の

```PHP
$i++
```

はfor文の中の処理が実行されるたびに実行される命令です。

サンプルコードでは変数$iの値を+1しています。

----

#### for文の全体の処理の流れの確認

```PHP
<?php
    for(処理A;処理B;処理C){
        処理D
    }
	処理E～
?>
```

このようなfor文の場合実行すると

- 処理Aが初めに呼ばれる
- 処理Bの条件を判断しTrueなら処理Bを実行Falseなら処理E以降を実行する
- 処理Dを実行したら処理Cを実行し再度処理Bの条件判定を実行する。

こんな感じ

## 変数の型

PHPの変数の型の説明をしていきます。

ここでは代表的な型を抜粋します。

| 型      | 意味               |
| ------- | ------------------ |
| integer | 整数の型           |
| boolean | 真偽値/TrueとFalse |
| float   | 少数の型           |
| string  | 文字列の型         |
| array   | 配列               |

変数の型はgettype関数で確認ができます。

```PHP
$int_test = 100;
$str_test = "aiueo";
$bool_test = True;
print(gettype($int_test));
// 実行結果>integer
print(gettype($str_test));
// 実行結果>>string
print(gettype($bool_test));
// 実行結果>>boolean
```

### 配列

配列array型は宣言方法が少し特殊になります。

```PHP
$array_1 = array(1,2,3,4);
```

このようにarray関数を使って宣言する方法と

```PHP
$array_2[0] = 1;
$array_2[1] = 2;
$array_2[2] = 3;
$array_2[3] = 4;
```

配列の番地（キー）を指定して値を埋め込む方法

```PHP
$array_3[] = 1;
$array_3[] = 2;
$array_3[] = 3;
$array_3[] = 4;
```

インデックスを指定しないで値を埋め込む方法

この場合0から自動的に番地が割り当てられます。

#### キー

キーは文字どうり配列から値を取り出すための鍵になります。

上記の方法で配列を宣言した場合キーは0から始まる数値が割り振られます。

##### 連想配列



キーは文字列を指定することも可能で文字列を指定した場合連想配列と呼ばれます。

```PHP
$array_4 = array("授業"=>"PHP","先生"=>"○○先生");
print($array["授業"]);
// 実行結果>>PHP
$array_5["授業"] =　"C言語";
$array_5["先生"] = "△△先生";
```

このような形で宣言することが可能です

#### 配列の一括表示

foreach文を使うことで配列の中身を簡単に取り出すことができます。

``` PHP
$array_1 = array(1,2,3,4,5,6);
foreach($array_1 as $value){
    //array_1の中身が順番に$valueという変数に格納されていく
    print($value);
}
```

foreach文はカッコ内の左側に中身を取り出したい変数を置きasを挟んで要素を取り出す為の変数を設定します。

## 文字列操作あれこれ

### 文字列の連結

文字列は . で連結することができる。

変数同士の連結も文字列同士の連結・変数と文字列の連結もできる

```PHP
$str1 = "PHPの";
$str2 = "授業"
print($str1.$str2);
// 出力結果>PHPの授業
$str3 = $str1.$str2;
//　連結した文字列を別の変数に代入することもできる
$str4 = "C言語の".$str2;
//　文字列と変数の連結
```

###　文字列の長さを取得

#### 文字列の長さをバイト数で取得する strlen関数

```PHP
$str_1 = "abcde";
print(strlen($str_1));
// 実行結果>5
$str_2 = "あいう";
print(strlen($str_2));
// 実行結果>6
```

ひらがな等全角文字は一文字につき2バイトになるので全角三文字*2バイトで6バイトとなります

#### 文字列の長さを文字数で取得する mb_strlen関数


```PHP
$str_1 = "abcde";
print(strlen($str_1));
// 実行結果>5
$str_2 = "あいう";
print(strlen($str_2));
// 実行結果>3
```

mb_strlen関数は文字数を取得しているので全角文字三文字でも3が返ってくる

#### 文字列を置換する

文字列の中の一部を別の内容に置き換えたいときはstr_replace()関数を使います。

```PHP
$str_1 ="今日の授業はC言語です。";
print($str_1);
// 実行結果>今日の授業はC言語です。
$str_2 = str_replace("C言語","PHP",$str_1);
print($str_2);
// 実行結果>今日の授業はPHPです。
```

関数には[置き換えたいワード],[書き換えるワード],[元となる文章もしくは文字列型の変数]の順番で値を指定します。



# WEB開発編



## フォームで値をやりとりする

##### 値を送信するフォーム

**from.html**

```php+HTML
<form action="./submit.php" method="POST">
 <input name="test" type="text">
 <input name="submit" type="submit" value="送信">
</form>
```

基本的なフォームの形

formタグのactionは送信先のファイル・methodは送信の方式を指定します。

inputタグのnameは値が格納される名前・typeは入力形式を指定します。

詳しくは後述します。

##### 値を受け取るPHPプログラム

```PHP
$post_data = $_POST["test"];
print($post_data);
```

送信された値はmethodがPOSTの場合は$\_POST["**inputのname**"]にmethodがGETの場合は$\_GET["**inputのname**"]に格納されます。

注意点としてformに送ったデータのname以外の値を$\_POST・$\_GET内に指定するとエラーが起きます。

対策としてisset関数を使うと値が存在できるか確認ができます。

```PHP
if(isset($_POST["name"])){
	$str_1 = $_POST["test"];
}
```

### POSTとGETの違い

ざっくりと2つの大きな違いは送信した情報がURLに乗るか乗らないかの違いです。

GET方式で情報を送信した場合URLは

![image-20200527104841673](./img/image-20200527104841673.png)
例としてYoutubeのURLを出しましたがこのURLをよく見てみるとwatch?の後ろにv=○○と続いています。

これがGETで送信されたデータになります。この場合このページがPHPで動いていたならば**$\_GET["v"]**で情報を読み取ることができます。

#### それぞれの利点

POSTはURLに送った情報が乗らないので他人に見られたくないデータ（パスワード）を送る際やGETでのデータ制限を超えるデータを送る際に活用できます。

GETはURLそのものにデータが格納されているので同じURLにアクセスすれば同じ情報を送信した扱いになります。なのでブックマークに保存したり情報を共有する際に便利です。



## CookieとSession

CookieとはWebサイトからブラウザに保存される情報のことです。

例えばですが一度ログインしたサイトに時間をおいて再度アクセスしてもログインした状態を保てるのはcookieにサイトにログインしたという情報が残っているからです。

##### Cookieに情報を書き込み、書き込んだ情報を読み取るコード

```PHP
/*
	Cookieを書き込むにはsetcookie関数を使います。
	setcookie("COOKIE名:必須","値:必須","保存期間","ディレクトリ(保存するフォルダ)")
	このような順番で情報を指定していきます。
*/
setcookie("color","red");
// このようにするとCookie名colorにredという値が設定されます。
//保存期間を指定していないのでこのCookieはブラウザを閉じると消滅します。
print($_COOKIE["color"]);
// 出力結果>red
setcookie("color","");
// cookieを削除する場合はこのように値を指定しないで実行すると内容を削除します
```

SESSIONはCOOKIEと同じようにデータを一時的に保存するものですがCOOKIEと違いサーバー側にデータが保存されます。

サーバー側に保存されるので改ざんがされにくく(COOKIEはブラウザ側にデータを保存する性質上改ざんがとてもされやすいです)

セキュリティ的に安全といえます。

##### SESSIONに情報を書き込み、書き込んだ情報を読み取るコード

```PHP
session_start();
// session_start関数を使うことでSESSIONに書き込みができるようになります
$_SESSION["color"] = "blue";
// これでColorという名前のSESSIONにblueという値が登録されました
print($_SESSION["color"]);
// 出力結果>bule
unset($_SESSION["color"]);
// セッションを削除するにはunset関数を使います。
```

